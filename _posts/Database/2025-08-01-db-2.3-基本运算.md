---
layout: post
title:  "2.3 基本运算"
category: "Database"
order: "5"

---

### 基本运算

**更名运算：as**：更名运算允许我们在计算过程中对关系或属性重命名。主要有下面几种作用

- 为派生属性定义属性名。在下面的查询中，salary * 1.1 这一属性不具有属性名，不同数据库的实现会为这个属性起不同的默认属性名。

  ```sql
  select ID, name, dept_name, salary * 1.1 from instructor;
  ```

  为了给这个属性起一个自定义的属性名，就对这个属性进行更名运算

  ```sql
  select ID, name, dept_name, salary * 1.1 as new_salary from instructor;
  ```

  这样，结果表中就有一个名为 new_salary 的属性

- 简化关系名称。有时一个查询中会反复用到一个关系名，如果关系名比较复杂或者比较长，写起来就很麻烦。我们可以用更名运算进行简化。下面列出了简化前后的两条指令。

  ```sql
  select instructor.name, teaches.course_id
  from instructor, teaches
  where instructor.ID = teaches.ID;
  
  select T.name, S.course_id
  from instructor as T, teaches as S
  where T.ID = S.ID;
  ```

- 同一个表中的元组比较。考虑这个查询 “找出工资比 Biology 系的最低工资高的所有教师的名字”。它的命令是

  ```sql
  select distinct T.name
  from instructor as T, instructor as S
  where T.salary > S.salary and S.dept_name = 'Biology';
  ```

  这个命令中将 instructor 关系与自身进行笛卡尔积。如果不使用更名操作，就无法区分参与笛卡尔积的两个关系各自的属性。

**字符串运算**

- SQL 中的字符串用一对单引号表示。如果字符串中包含单引号，应该用两个单引号来表示。

- 在 MySQL 和 SQLServer 中，字符串默认是大小写不敏感的，这可以被修改。SQL 标准中字符串是大小写敏感的。

- 不同数据库系统提供不同的字符串函数集。常用的函数包括， trim(s)：去除字符串后面的空格，lower(s)：转换为小写，upper(s)：转换为大写，等等。

- like 操作可以实现模式匹配。% 表示任意字串，_ 表示任意字符。like 是大小写敏感的。like 将左运算数作为目标，右运算数作为模式进行匹配，结果是布尔值。例如：

  ```sql
  select dept_name from department
  where building like '%Watson%';
  ```

**全部属性：select ***：为了直接获取一个关系，可以不用列出这个关系的全部属性，用 * 代替，例如

```sql
select * from instructor;

select instructor.* from instructor, teaches
where instructor.ID = teaches.ID;
```

**结果排序：order by**：为了让查询结果按某属性排序，使用 order by 指令。desc 关键字表示降序，asc 关键字表示升序。排序可以在多个属性上进行，即先按第一个属性排序，相同的再按第二个属性排序。例如

```sql
select * from instructor
order by salary desc, name asc;
```

**where 谓词**

- between ... and 谓词能用于方便地判断一个值是否位于一个区间内。它还具有否定形式 not between ... and。例如

  ```sql
  select name from instructor
  where salary between 90000 and 100000;
  ```

- 谓词语句可以直接比较元组的大小，这会按照元组的字典序比较。例如，下面两个命令是等价的

  ```sql
  select name, course_id from instructor, teaches
  where (instructor.ID, dept_name) = (teaches.ID, 'Biology');
  
  select name, course_id from instructor, teaches
  where instructor.Id = teaches.ID and dept_name = 'Biology';
  ```