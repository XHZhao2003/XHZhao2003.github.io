---
layout: post
title:  "1.数据库关系模型"
category: "数据库"
order: "1"
---



## 数据库关系模型

关系模型是现代数据库的主流数据模型，相比于数据模型或网络模型，关系模型优势主要体现在它非常简单，更方便编程者。因而使用关系模型的的数据库被称为关系数据库。

本文介绍数据库关系模型的基本构成。

### 1. 关系数据库的结构

如果你用过 Excel 表格，那么它给你的第一印象就是关系模型的含义。

- 关系数据库由若干个表（table）组成
- 每个表代表了一个关系模式，由行和列组成。每一行（row）表示一个关系实例（relation instance），每一列（column）表示一个属性（attribute）

这个模型之所以被命名为“关系”模型，是因为它在数学上与集合论中的“关系”联系紧密。不过目前我们不打算详细讨论深层次的数学模型。

关于表格中的具体数值，下面是几条说明

- 每个属性的取值集合称为该属性的域（domain）
- 如果域中的元素被看作是不可再分的单元，域就是原子的（atomic）。我们目前认为域是原子的，也就是你不能把几个格子中的数据填入一个格子中。
- 空（null）是一个特殊且重要的值，表示位置或不存在

### 2. 数据库模式

在关系数据库的语境下，数据库模式是关系模式。一个关系模式指的是一个表中包含的属性序列以及每个属性的域。与之相关的概念是关系实例，它指的是数据库模式在某个时刻的快照。

例如，为了存储大学中的院系信息，可以定义这样的关系模式

```
department(dept_name, building, budget)
```

又例如，为了记录教授的授课信息，可以定义这样的关系模式

```
teach(ID, course_id, sec_id, semester, year)
```

### 3. 码

码（key）也被翻译为关键码，键值。码的作用是唯一标识每个实例。

- 关系模式的一个超码（superkey）是一个属性集合，使得任意两个实例都保证在这些属性上不全相同。超码的任意超集也都是超码，因此超码中可能存在无关紧要的属性。
- 如果一个超码的任意真子集都不是超码，它就称为候选码（candidate）。候选码也可以不唯一。候选码可以是单个属性，也可以包含多个属性。
- 主码（primary key）是数据库模式实际采用的候选码。

选择什么属性作为主码是由关系模式的设计者决定的，要考虑到这些因素。

- 主码属性要能严格确保实例的唯一性
- 实例的主码属性应该很少变动

一种很常见的情况是，一个关系模式 $r_1$ 需要使用另一个关系模式 $r_2$ 的主码作为自身的属性。这个属性在 $r_1$ 中就称为参照 $r_2$ 的外码（或外键，foreign key）。

例如，上文描述的 teach 关系模式的属性组 (course_id, sec_id) 就可能是另一个关系模式 course 的主码，因此 teach 包含参照 course 的外键。

注意，如果一个或多个属性被定义为外键，它的值就必须等于被参照模式中，某个真实存在的实例的主码。这称为参照完整性约束。

### 4. 关系查询语言

查询语言就是用户从数据库中获取信息的语言，大致分为过程化的和非过程化的

- 过程化语言中，用户给出数据库要执行的基本运算，以得到目标结果
- 非过程化语言中，用户仅需对目标结果进行描述，由数据库自行计算

最广泛使用的查询语言 SQL 既包含过程化的成分，也包含非过程化的成分

### 5. 关系运算

过程化的查询语言中，用户可以使用的基本运算操作就是关系运算。关系运算输入一个或多个关系实例（也就是表），输出一个表。下面展示几个常用的关系运算

- select 运算，输入一个关系和一个谓词，输出该关系中满足该谓词的实例所构成的子关系
- select 运算还接收一个关系的若干属性作为参数，这样，输出的关系中就只包含这些属性
- 连接运算，将两个关系按元组合并为一个关系，例如，如果两个关系的主码相同，就可以把其他属性合并。实际的连接运算可以应对更复杂的情况
- 笛卡尔积运算，返回两个关系的笛卡儿积。也就是，$r_1$ 中的每一行会与  $r_2$ 中的每一行直接连接。

由于关系模式可以用集合论的数学模型建模，这些关系运算也都可以写成关系代数的形式。
